'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var React = require('react');
var constants$1 = require('../../../constants.js');
var isShowMoreAnnotationsButtonVisible = require('../../../utilities/isShowMoreAnnotationsButtonVisible.js');
var constants = require('../constants.js');

function useShowMoreAnnotationsButton({
  isShowingAllAnnotations,
  positions
}) {
  const rowCount = React.useMemo(() => {
    return Math.max(...positions.map(({
      row
    }) => row)) + 1;
  }, [positions]);
  const showMoreButtonOffset = React.useMemo(() => {
    if (!isShowingAllAnnotations) {
      return 0;
    }

    return isShowMoreAnnotationsButtonVisible.isShowMoreAnnotationsButtonVisible(rowCount) ? constants.SHOW_MORE_BUTTON_OFFSET : 0;
  }, [rowCount, isShowingAllAnnotations]);
  const totalRowHeight = React.useMemo(() => {
    return positions.reduce((total, {
      y,
      row
    }) => {
      if (!isShowingAllAnnotations && row > constants$1.COLLAPSED_ANNOTATIONS_COUNT) {
        return total;
      }

      if (y > total) {
        return y;
      }

      return total;
    }, 0) + constants.PILL_HEIGHT + constants.PILL_ROW_GAP + showMoreButtonOffset;
  }, [isShowingAllAnnotations, showMoreButtonOffset, positions]);
  return {
    rowCount,
    totalRowHeight
  };
}

exports.useShowMoreAnnotationsButton = useShowMoreAnnotationsButton;
